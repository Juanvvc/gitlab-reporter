(function(e){function t(t){for(var s,o,i=t[0],c=t[1],l=t[2],d=0,p=[];d<i.length;d++)o=i[d],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&p.push(n[o][0]),n[o]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(e[s]=c[s]);u&&u(t);while(p.length)p.shift()();return r.push.apply(r,l||[]),a()}function a(){for(var e,t=0;t<r.length;t++){for(var a=r[t],s=!0,i=1;i<a.length;i++){var c=a[i];0!==n[c]&&(s=!1)}s&&(r.splice(t--,1),e=o(o.s=a[0]))}return e}var s={},n={app:0},r=[];function o(t){if(s[t])return s[t].exports;var a=s[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=s,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)o.d(a,s,function(t){return e[t]}.bind(null,s));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var u=c;r.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"034f":function(e,t,a){"use strict";var s=a("8a23"),n=a.n(s);n.a},"3dc8":function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var s=a("2b0e"),n=(a("5363"),a("f309"));s["a"].use(n["a"]);var r=new n["a"]({icons:{iconfont:"mdi"},theme:{themes:{light:{primary:"#0288D1",secondary:"#FFC400",accent:"#FBC02D",error:"#f44336",warning:"#FFB300",info:"#2196f3",success:"#4caf50"},dark:{primary:"#0288D1",secondary:"#FFC400",accent:"#FBC02D",error:"#f44336",warning:"#FFB300",info:"#2196f3",success:"#4caf50"}}}}),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",[a("v-app-bar",{attrs:{app:"",dark:"",color:"primary darken-2"}},[a("v-toolbar-title",[a("v-col",[a("span",[a("v-row",{attrs:{align:"center"}},[e._v(" GitLab reporter for: "),e.loggedUser.is_admin?a("span",[a("v-select",{attrs:{items:e.users,"item-text":"name","item-value":"id",outlined:"",dense:""},on:{change:e.changeUser},model:{value:e.selectedUser,callback:function(t){e.selectedUser=t},expression:"selectedUser"}})],1):a("span",[e._v(" "+e._s(e.currentUser.name)+" ")])])],1),e.loggedUser.is_admin?e._e():a("span",{staticClass:"caption"},[e._v(" Server: "),a("strong",[e._v(e._s(e.gitlab))]),e._v(". Clocking email: "),a("strong",[e._v(e._s(e.emailSessionTime))]),e._v(". Reporting email: "),a("strong",[e._v(e._s(e.emailReportHours))]),e._v(". Report to GitLab: "),a("strong",[e._v(e._s(e.reportHours))]),e._v(". ")])])],1)],1),a("v-content",[a("v-container",{attrs:{fluid:""}},[a("p",{staticClass:"hidden-sm-and-down"},[e._v(" Comments can include "),a("a",{attrs:{href:"https://docs.gitlab.com/ee/user/project/quick_actions.html"}},[e._v("quick actions")]),e._v(", such as "),a("em",[e._v("/done")]),e._v(" or "),a("em",[e._v("/close")]),e._v(". GitLab marks a task as done if a user comments on it. To prevent this, a "),a("em",[e._v("/todo")]),e._v(" will be sent automatically after all comments, unless "),a("em",[e._v("/done")]),e._v(" or "),a("em",[e._v("/close")]),e._v(" is used. ")]),a("session-control",{attrs:{"current-date":e.currentDate}}),a("v-tabs",{staticClass:"elevation-2",attrs:{"background-color":"primary","icons-and-text":"",centered:""},on:{change:e.tabChanged},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[e.gitlabConfigured?a("v-tab",{attrs:{href:"#tab-reporter"}},[e._v("Reporter"),a("v-icon",[e._v("mdi-account-clock")])],1):e._e(),e.gitlabConfigured?a("v-tab",{attrs:{href:"#tab-calendar"}},[e._v("Calendar"),a("v-icon",[e._v("mdi-calendar-blank")])],1):e._e(),e.gitlabConfigured?a("v-tab",{attrs:{href:"#tab-project"}},[e._v("Project"),a("v-icon",[e._v("mdi-file-tree")])],1):e._e(),a("v-tab",{attrs:{href:"#tab-config"}},[e._v("Settings"),a("v-icon",[e._v("mdi-settings")])],1)],1),a("v-tabs-items",{model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[e.gitlabConfigured?a("v-tab-item",{attrs:{value:"tab-reporter"}},[a("v-card",{attrs:{flat:""}},[a("v-card-text",[a("h2",[e._v("Open issues and TODOs for "+e._s(e.currentUser.name))]),a("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("p",e._g({},s),[e._v("Number of tasks: "+e._s(e.issues.length)+".")])]}}],null,!1,2701077979)},[a("span",[e._v("This list includes issues assigned to you and issues where you are mentioned.")])]),e.issues.length>=e.maxTasks?a("v-alert",{attrs:{type:"warning"}},[e._v(" At most, only "+e._s(e.maxTasks)+" random issues are shown. Do you really have more than "+e._s(e.maxTasks)+" open issues? ")]):e._e(),a("issues-table"),a("report-bar",{on:{"report-hours":function(t){return e.$store.dispatch("gitlab/reportHours",t)},"change-date":function(t){e.currentDate=t.date}}})],1)],1)],1):e._e(),e.gitlabConfigured?a("v-tab-item",{attrs:{value:"tab-calendar"}},[a("v-card",{attrs:{flat:"",height:"800px"}},[a("h2",[e._v("Calendar")]),a("p",[e._v("The calendar only shows open tasks")]),a("calendar-view",{staticClass:"theme-default",attrs:{"starting-day-of-week":1,events:e.calendarEvents,"show-date":e.calendarDate},on:{"show-date-change":e.setCalendarDate},scopedSlots:e._u([{key:"header",fn:function(t){return a("calendar-view-header",{attrs:{"header-props":t.headerProps},on:{input:e.setCalendarDate}})}}],null,!1,476651339)})],1)],1):e._e(),e.gitlabConfigured?a("v-tab-item",{attrs:{value:"tab-project"}},[a("v-card",{attrs:{flat:""}},[a("v-card-text",[a("h2",[e._v("Project information")]),a("search-project",{on:{change:function(t){return e.changeSelectedProject(arguments[0])}}}),a("issues-table"),a("project-gantt",{attrs:{projectId:e.selectedProjectId,height:"800px"}})],1)],1)],1):e._e(),a("v-tab-item",{attrs:{value:"tab-config"}},[a("config-tab")],1)],1),a("message-bar")],1),a("v-footer",{staticClass:"pa-3"},[a("v-spacer"),a("div",[e._v("GitLab reporter v"+e._s(e.app_version)+". Â© Juan Vera, "+e._s((new Date).getFullYear()))])],1)],1)],1)},i=[],c=(a("99af"),a("4de4"),a("5530")),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-data-table",{attrs:{items:e.issues,headers:e.headers,"must-sort":!0,loading:e.loading,"hide-default-footer":"","disable-pagination":"",dense:""},scopedSlots:e._u([{key:"body",fn:function(t){var s=t.items;return[a("tbody",e._l(s,(function(t,s){return a("tr",{key:t.name},[a("td",[a("a",{attrs:{href:t.project_url,target:"_blank"}},[e._v(e._s(t.project_name))])]),a("td",[a("a",{attrs:{href:t.web_url,target:"_blank"}},[e._v(e._s(t.title))])]),a("td",{staticClass:"hidden-sm-and-down"},[a("status-tag",{attrs:{issue:t}})],1),a("td",{staticClass:"hidden-sm-and-down"},[a("tag-editor",{attrs:{"data-index":s,tags:t.labels},on:{"update-tags":e.updateTags}})],1),a("td",{staticClass:"hidden-sm-and-down"},[e._v(e._s(t.due_date))]),a("td",{staticClass:"hidden-sm-and-down"},[e._v(e._s(t.assignee_names))]),a("td",{staticClass:"hidden-sm-and-down"},[e._v(e._s(t.time_stats.human_time_estimate))]),a("td",{staticClass:"hidden-sm-and-down"},[e._v(e._s(t.time_stats.human_total_time_spent))]),a("td",[a("v-row",{attrs:{align:"center"}},[a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(s){var n=s.on;return[a("v-btn",e._g({attrs:{small:"",text:"",icon:""},on:{click:function(a){return e.editReport(t)}}},n),[a("v-icon",[e._v("mdi-progress-clock")])],1)]}}],null,!0)},[a("span",[e._v("Show a dialog to report tasks")])]),a("span",[e._v(e._s(t.report_hours)+"h")])],1)],1)])})),0)]}}])}),a("edit-data-dialog",{ref:"editDataDialog"})],1)},u=[],d=(a("96cf"),a("1da1")),p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-dialog",{attrs:{"max-width":"500px",persistent:""},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[e._v(e._s(e.title))])]),a("v-card-text",e._l(e.fields,(function(t){return a("div",{key:t.name},["textfield"===t.type?a("v-text-field",{attrs:{label:e.getLabel(t),hint:t.hint,clearable:""},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"field.value"}}):e._e(),"textarea"===t.type?a("v-textarea",{attrs:{label:e.getLabel(t),hint:t.hint,clearable:""},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"field.value"}}):e._e()],1)})),0),a("v-card-actions",[a("v-btn",{attrs:{color:"secondary",text:""},nativeOn:{click:function(t){return e.close(!1)}}},[e._v(e._s(e.cancel))]),a("v-spacer"),a("v-btn",{attrs:{color:"primary",text:""},nativeOn:{click:function(t){return e.close(!0)}}},[e._v(e._s(e.save))])],1)],1)],1)},m=[],g=(a("4160"),a("fb6a"),a("b0c0"),a("d3b7"),a("159b"),{props:{cancel:{type:String,mandatory:!1,default:function(){return"Cancel"}},save:{type:String,mandatory:!1,default:function(){return"Save"}}},data:function(){return{title:"NO TITLE",fields:[],visible:!1}},methods:{edit:function(e){var t=this,a=e.title,s=e.fields;return this.title=a,this.fields=s,this.visible=!0,new Promise((function(e){t.resolve=e}))},getLabel:function(e){return void 0!==e.label?e.label:e.name.charAt(0).toUpperCase()+e.name.slice(1)},getPrependIcon:function(e){return void 0!==e.prependIcon?e.prependIcon:""},close:function(e){if(e){var t={};this.fields.forEach((function(e){t[e.name]=e.value})),this.resolve(t),this.visible=!1}else this.resolve(null),this.visible=!1}}}),v=g,f=a("2877"),b=a("6544"),h=a.n(b),_=a("8336"),w=a("b0af"),k=a("99d9"),x=a("169a"),T=a("2fa4"),y=a("8654"),j=a("a844"),S=Object(f["a"])(v,p,m,!1,null,null,null),O=S.exports;h()(S,{VBtn:_["a"],VCard:w["a"],VCardActions:k["a"],VCardText:k["b"],VCardTitle:k["c"],VDialog:x["a"],VSpacer:T["a"],VTextField:y["a"],VTextarea:j["a"]});var R=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-chip",{staticClass:"compact-form",attrs:{small:"",label:"",color:e.color,"text-color":e.textColor}},[e._v(" "+e._s(e.text)+" ")])},C=[],E=a("53ca");function D(e){return Object(E["a"])(e)===String?e:JSON.stringify(e,null,2)}var P={log:function(e){},error:function(e){console.error(D(e))},info:function(e){},warning:function(e){}},I=a("f817"),U={props:{issue:{mandatory:!0,type:Object}},computed:{textColor:function(){return""!==this.color?"white":"black"},color:function(){if(!this.issue)return"";if("closed"===this.issue.state)return"success";if("opened"===this.issue.state){var e=Object(I["a"])().diff(Object(I["a"])(this.issue.due_date),"days");if(0===e)return"warning";if(e>0)return"error"}return""},text:function(){return this.issue?this.issue.state:""}}},V=U,$=a("cc20"),M=Object(f["a"])(V,R,C,!1,null,null,null),L=M.exports;h()(M,{VChip:$["a"]});var H=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-combobox",{attrs:{label:"Tags",multiple:"",chips:"",tags:"",dense:"",solo:"","hide-details":"","prepend-icon":"","append-icon":"",clearable:""},on:{input:function(t){return e.$emit("update-tags",{dataIndex:e.dataIndex,tags:e.myTags})}},scopedSlots:e._u([{key:"selection",fn:function(t){return[a("base-tag",{attrs:{close:"",tag:t.item},on:{"close-tag":function(a){return e.deleteTag(t.item)}}})]}}]),model:{value:e.myTags,callback:function(t){e.myTags=t},expression:"myTags"}})},A=[],Y=(a("c975"),a("a434"),a("a9e3"),a("2909")),N=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-chip",{staticClass:"mychip",attrs:{small:"",label:"",color:e.tagBackgroundColor,"text-color":e.tagTextColor,close:e.close},on:{"click:close":function(t){return e.$emit("close-tag",e.tag)}}},[e._v(" "+e._s(e._f("capitalize")(e.tag))+" ")])},B=[],G=(a("25f0"),{filters:{capitalize:function(e){return e?(e=e.toString(),e.charAt(0).toUpperCase()+e.slice(1)):""}},props:{tag:{type:String,mandatory:!0,default:function(){return"TAG"}},dangerTags:{type:Array,mandatory:!1,default:function(){return this.$store.state.config.IMPORTANT_LABELS}},warningTags:{type:Array,mandatory:!1,default:function(){return this.$store.state.config.CHECK_LABELS}},successTags:{type:Array,mandatory:!1,default:function(){return this.$store.state.config.SEEN_LABELS}},close:{type:Boolean,mandatory:!1,default:!1}},computed:{tagType:function(){return this.dangerTags.indexOf(this.tag.toLowerCase())>-1?3:this.warningTags.indexOf(this.tag.toLowerCase())>-1?2:this.successTags.indexOf(this.tag.toLowerCase())>-1?1:0},tagBackgroundColor:function(){return["grey","green","orange","red"][this.tagType]},tagTextColor:function(){return["black","white","white","white"][this.tagType]}}}),F=G,J=(a("a611"),Object(f["a"])(F,N,B,!1,null,"1ec8018d",null)),q=J.exports;h()(J,{VChip:$["a"]});var z={components:{"base-tag":q},props:{dataIndex:{type:Number,default:function(){return 0}},tags:{type:Array,default:function(){return[]}}},data:function(){return{myTags:[]}},created:function(){void 0===this.tags?this.myTags=[]:this.myTags=this.tags},methods:{deleteTag:function(e){this.myTags.splice(this.myTags.indexOf(e),1),this.myTags=Object(Y["a"])(this.myTags),this.$emit("update-tags",{dataIndex:this.dataIndex,tags:this.myTags})}}},K=z,W=a("2b5d"),Q=Object(f["a"])(K,H,A,!1,null,null,null),X=Q.exports;h()(Q,{VCombobox:W["a"]});var Z=a("2f62"),ee={components:{EditDataDialog:O,StatusTag:L,TagEditor:X},data:function(){return{headers:[{text:"Project",value:"project_name",sortable:!0,width:"10%"},{text:"Title",value:"title",sortable:!0,width:"30%"},{text:"Status",value:"status",sortable:!1,class:"hidden-sm-and-down"},{text:"Labels",value:"labels",sortable:!1,class:"hidden-sm-and-down"},{text:"Due date",value:"due_date",sortable:!0,class:"hidden-sm-and-down"},{text:"Assignees",value:"assignees",sortable:!1,class:"hidden-sm-and-down"},{text:"Estimated",value:"estimated",sortable:!1,class:"hidden-sm-and-down"},{text:"Spent",value:"spent",sortable:!1,class:"hidden-sm-and-down"},{text:"Today",value:"report",sortable:!1}],selectedIssue:null}},computed:Object(c["a"])({},Object(Z["c"])("gitlab",["loading","issues"])),methods:{editReport:function(e){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function a(){var s,n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:s=0;case 1:if(!(s<t.issues.length)){a.next=7;break}if(t.issues[s].id!=e.id){a.next=4;break}return a.abrupt("break",7);case 4:s++,a.next=1;break;case 7:return n={title:'Report to "'.concat(e.project_name," - ").concat(e.title,'"'),fields:[{label:"Hours to report",name:"report_hours",value:e.report_hours,type:"textfield",hint:"Hours using a float number"},{label:"Optional comment",name:"report_comment",value:e.report_comment,type:"textarea",hint:"Comments can include quick actions, such as /done or /close"}]},a.next=10,t.$refs.editDataDialog.edit(n);case 10:r=a.sent,r&&t.$store.commit("gitlab/editIssue",{issueIndex:s,newMetadata:r});case 12:case"end":return a.stop()}}),a)})))()},updateTags:function(e){var t=e.dataIndex,a=e.tags,s={tags:a};this.$store.commit("gitlab/editIssue",{issueIndex:t,newMetadata:s}),this.$store.dispatch("gitlab/changeLabels",{issueIndex:t})}}},te=ee,ae=(a("9bca"),a("8fea")),se=a("132d"),ne=a("0fd9"),re=a("3a2f"),oe=Object(f["a"])(te,l,u,!1,null,null,null),ie=oe.exports;h()(oe,{VBtn:_["a"],VDataTable:ae["a"],VIcon:se["a"],VRow:ne["a"],VTooltip:re["a"]});var ce=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-col",[a("v-row",{attrs:{align:"center"}},[a("v-spacer"),a("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[a("v-menu",{ref:"dateMenu",attrs:{"close-on-content-click":!1,"nudge-right":40,"return-value":e.date,transition:"scale-transition","offset-y":"","min-width":"290px"},on:{"update:returnValue":function(t){e.date=t},"update:return-value":function(t){e.date=t}},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("v-text-field",e._g({attrs:{label:"Day to report","prepend-icon":"mdi-calendar-blank",readonly:""},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}},s))]}}]),model:{value:e.dateMenu,callback:function(t){e.dateMenu=t},expression:"dateMenu"}},[a("v-date-picker",{attrs:{"first-day-of-week":"1"},on:{input:function(t){return e.changeDate(e.date)}},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1)],1),a("v-spacer"),a("v-col",[e._v(" Total hours to report: "),a("strong",[e._v(e._s(Number(e.totalHoursToReport).toFixed(2)))]),e._v(". ")]),a("v-spacer"),a("v-col",[a("v-btn",{attrs:{color:"primary",dark:""},nativeOn:{click:function(t){return e.$emit("report-hours",{date:e.date})}}},[e._v(" Report ")])],1)],1)],1)},le=[],ue={data:function(){return{date:Object(I["a"])().format("YYYY-MM-DD"),dateMenu:!1}},computed:Object(c["a"])({totalHoursToReport:function(){for(var e=0,t=0;t<this.issues.length;t++)e+=parseFloat(this.issues[t].report_hours);return e}},Object(Z["c"])("gitlab",["issues"])),methods:{changeDate:function(e){this.$refs.dateMenu.save(e),this.$emit("change-date",{date:e})}}},de=ue,pe=a("62ad"),me=a("2e4b"),ge=a("e449"),ve=Object(f["a"])(de,ce,le,!1,null,null,null),fe=ve.exports;h()(ve,{VBtn:_["a"],VCol:pe["a"],VDatePicker:me["a"],VMenu:ge["a"],VRow:ne["a"],VSpacer:T["a"],VTextField:y["a"]});var be=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-autocomplete",{attrs:{label:"Project Name",hint:"Enter at least three characters to search for projects",loading:e.isLoading,items:e.projects,"item-text":"name","item-value":"id",disabled:e.disabled,"search-input":e.search},on:{"update:searchInput":function(t){e.search=t},"update:search-input":function(t){e.search=t},change:function(t){return e.$emit("change",e.selectedProject)}},model:{value:e.selectedProject,callback:function(t){e.selectedProject=t},expression:"selectedProject"}})},he=[],_e=(a("d81d"),{PROJECTS_PER_PAGE:40,ASSIGNED_TO_ME:"assigned-to-me",UPDATE_DURATION:3e4,IMPORTANT_LABELS:["important","relevant","prioridad alta"],CHECK_LABELS:["check","warning"],SEEN_LABELS:["seen","unimportant","doing"]}),we=a("bc3a"),ke={data:function(){return{search:"",isLoading:!1,projects:[],selectedProject:void 0}},computed:Object(c["a"])({disabled:function(){return!this.gitlab||!this.privateToken}},Object(Z["c"])("gitlab",["gitlab","privateToken"]),{},Object(Z["b"])("gitlab",["gitlabURL"])),watch:{search:function(e){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function a(){var s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!t.isLoading&&t.gitlab&&t.privateToken){a.next=2;break}return a.abrupt("return");case 2:if(e&&!(e.length<3)){a.next=5;break}return t.projects=[],a.abrupt("return");case 5:return t.isLoading=!0,a.prev=6,a.next=9,we.get("".concat(t.gitlabURL,"/projects"),{params:{simple:"true",archived:"true",order_by:"name",sort:"asc",per_page:_e.PROJECTS_PER_PAGE,search:e},headers:{"Private-Token":t.privateToken}});case 9:s=a.sent,s&&(t.projects=s.data.map((function(e){return{name:e.name,id:e.id}}))),a.next=16;break;case 13:a.prev=13,a.t0=a["catch"](6),t.$store.commit("messages/message",{type:"error",message:a.t0},{root:!0});case 16:t.isLoading=!1;case 17:case"end":return a.stop()}}),a,null,[[6,13]])})))()}}},xe=ke,Te=a("c6a6"),ye=Object(f["a"])(xe,be,he,!1,null,null,null),je=ye.exports;h()(ye,{VAutocomplete:Te["a"]});var Se=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{height:e.height}},[a("svg",{ref:"mygantt"})])},Oe=[],Re=(a("a15b"),a("221e")),Ce=a("bc3a");function Ee(e){var t=Object(I["a"])(e.start).format("YYYY/MM/DD"),a=Object(I["a"])(e.end).format("YYYY/MM/DD");return e.web_url?'\n    <div class="title">'.concat(e.name,'</div>\n    <div class="subtitle">Dates: ').concat(t," - ").concat(a,"</div>\n    <div>Assignees: ").concat(e.assignee_names,'</div>\n    <div><a href="').concat(e.web_url,'" target="_blank">GITLAB link</a></div>\n    '):'\n    <div class="title">'.concat(e.name,'</div>\n    <div class="subtitle">Dates: ').concat(t," - ").concat(a,"</div>\n    ")}var De={props:{projectId:{mandatory:!0,type:Number},height:{mandatory:!1,type:String,default:function(){return"800px"}}},computed:Object(c["a"])({},Object(Z["c"])("gitlab",["privateToken","gitlab"]),{},Object(Z["b"])("gitlab",["gitlabURL"])),watch:{projectId:function(e){void 0!==e&&this.downloadProjectInfo(e)}},methods:{downloadProjectInfo:function(e){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function a(){var s,n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.gitlab&&t.privateToken){a.next=2;break}return a.abrupt("return");case 2:return s=[],a.next=5,t.downloadMilestones(e);case 5:n=a.sent,n.forEach(function(){var e=Object(d["a"])(regeneratorRuntime.mark((function e(a){var n,r,o,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=Object(c["a"])({},a),n.progress=0,e.next=4,t.downloadIssues(a._id);case 4:r=e.sent,o=0,i=r.length,i>0&&(r.forEach((function(e){var t=e.progress/100;o+=t,e.end>n.end&&(n.end=e.end)})),n.progress=o/i*100),s.push(n),r.map((function(e){s.push(e)}));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),r=new Re["a"](t.$refs["mygantt"],s,{editable:!1,custom_popup_html:Ee}),r.change_view_mode("Week");case 9:case"end":return a.stop()}}),a)})))()},downloadMilestones:function(e){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.abrupt("return",Ce.get("".concat(t.gitlabURL,"/projects/").concat(e,"/milestones"),{headers:{"Private-Token":t.privateToken}}).then((function(e){return e.data.map((function(e){return{start:e.start_date?e.start_date:e.created_at,end:e.due_date?e.due_date:e.start_date?e.start_date:e.created_at,name:e.title,id:"milestone-".concat(e.id),_id:e.id}}))})));case 1:case"end":return a.stop()}}),a)})))()},downloadIssues:function(e){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Ce.get("".concat(t.gitlabURL,"/projects/").concat(t.projectId,"/milestones/").concat(e,"/issues"),{headers:{"Private-Token":t.privateToken}}).then((function(t){return t.data.map((function(t){return{start:t.due_date?t.due_date:(new Date).toISOString(),end:t.due_date?t.due_date:(new Date).toISOString(),name:t.title,progress:"closed"===t.state?100:0,dependencies:"milestone-".concat(e),id:"issue-".concat(t.id),web_url:t.web_url,assignee_names:t.assignees.map((function(e){return e.name})).join(", "),_id:t.id}}))}));case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}}),a)})))()}}},Pe=De,Ie=(a("d647"),Object(f["a"])(Pe,Se,Oe,!1,null,"5a78e618",null)),Ue=Ie.exports,Ve=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{fluid:""}},[a("v-row",{attrs:{align:"center",justify:"start"}},[a("v-col",{staticClass:"hidden-sm-and-down",attrs:{cols:"1"}},[e._v("Sessions:")]),a("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("v-btn",e._g({staticClass:"white--text",attrs:{text:"",color:"green"},on:{click:function(t){return e.$store.dispatch("sessions/startSession")}}},s),[a("v-icon",[e._v("mdi-clock-in")]),e._v(" Start session")],1)]}}])},[a("span",[e._v("Start a session and (optionally) send the email inmediately")])]),a("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("v-btn",e._g({staticClass:"white--text",attrs:{text:"",color:"red"},on:{click:function(t){return e.$store.dispatch("sessions/stopSession")}}},s),[a("v-icon",[e._v("mdi-clock-out")]),e._v(" End session")],1)]}}])},[a("span",[e._v("Stop a session and (optionally) send the email inmediately")])]),a("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("v-btn",e._g({staticClass:"white--text",attrs:{text:"",color:"primary"},on:{click:e.customSessions}},s),[a("v-icon",[e._v("mdi-clock")]),e._v(" Custom sessions")],1)]}}])},[a("span",[e._v("Enter the session information manually and send inmediately an email")])]),a("v-spacer"),a("v-col",[e._v(" "+e._s(e.sessionText)+" ")])],1),a("edit-data-dialog",{ref:"editDataDialog",attrs:{save:"Send"}})],1)},$e=[];a("b680");function Me(e){for(var t={start:"?",end:"?"},a=0,s=[],n=0;n<e.length;n++){var r=e[n];"start"===r.action?t.start=r.time:(t.end=r.time,"?"!==t.start&&(a+=Object(I["a"])(t.end,["H:m"]).diff(Object(I["a"])(t.start,["H:m"]),"minutes")),s.push("".concat(t.start,"-").concat(t.end)),t={start:"?",end:"?"})}return"?"!==t.start&&(s.push("".concat(t.start,"-?")),a+=Object(I["a"])().diff(Object(I["a"])(t.start,["H:m"]),"minutes")),{duration:a/60,sessions:s.join(",")}}var Le={components:{EditDataDialog:O},props:{currentDate:Object(I["a"])()},data:function(){return{sessions:void 0,duration:"0"}},computed:Object(c["a"])({sessionText:function(){return this.sessions?"Sessions: ".concat(this.sessions,". Total ").concat(this.duration," hours."):"No sessions detected in this computer"},lastSessionAction:function(){if(this.sessions)return this.activeSessions[this.activeSessions.length-1].action}},Object(Z["c"])("sessions",["activeSessions"])),watch:{activeSessions:function(){this.updateSessions()}},mounted:function(){var e=this;this.updateSessions(),this.interval=setInterval((function(){return e.updateSessions()}),_e.UPDATE_DURATION)},beforeDestroy:function(){this.interval&&(clearInterval(this.interval),this.interval=void 0)},methods:{customSessions:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={title:"Custom sessions",fields:[{label:"Sessions",name:"sessions",value:Me(e.activeSessions).sessions,type:"textfield",hint:"Example: 09:00-13:00,14:00-15:00"},{label:"Date",name:"date",value:Object(I["a"])(e.currentDate).format("YYYY-MM-DD"),type:"textfield",hint:"Example: 2019-08-31"}]},t.next=3,e.$refs.editDataDialog.edit(a);case 3:s=t.sent,s&&(e.$store.dispatch("sessions/customSessions",s),e.updateSessions());case 5:case"end":return t.stop()}}),t)})))()},updateSessions:function(){var e=Me(this.activeSessions);this.sessions=e.sessions,this.duration=Number(e.duration).toFixed(2)}}},He=Le,Ae=a("a523"),Ye=Object(f["a"])(He,Ve,$e,!1,null,null,null),Ne=Ye.exports;h()(Ye,{VBtn:_["a"],VCol:pe["a"],VContainer:Ae["a"],VIcon:se["a"],VRow:ne["a"],VSpacer:T["a"],VTooltip:re["a"]});var Be=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",{attrs:{flat:""}},[a("v-card-text",[a("h2",[e._v("Settings")]),a("p",[e._v(" These parameters are stored locally in your browser's cache, not in any server. ")]),a("v-text-field",{attrs:{value:e.$store.state.gitlab.gitlab,label:"URL to the gitlab server",hint:"If empty, to not get issues and projects",required:""},on:{change:function(t){return e.$store.commit("gitlab/gitlab",t)}}}),a("v-expand-transition",[a("v-text-field",{directives:[{name:"show",rawName:"v-show",value:e.$store.state.gitlab.gitlab,expression:"$store.state.gitlab.gitlab"}],attrs:{value:e.$store.state.gitlab.privateToken,label:"Gitlab private token",hint:"Get the token from "+e.tokenURL,required:""},on:{change:function(t){return e.$store.commit("gitlab/privateToken",t)}}})],1),a("v-expand-transition",[a("div",{directives:[{name:"show",rawName:"v-show",value:e.gitlabConfiguredProperly,expression:"gitlabConfiguredProperly"}]},[a("v-switch",{attrs:{label:"Calendar: show milestones"},model:{value:e.showMilestones,callback:function(t){e.showMilestones=t},expression:"showMilestones"}}),a("v-switch",{attrs:{label:"Report hours to gitlab"},model:{value:e.reportHours,callback:function(t){e.reportHours=t},expression:"reportHours"}}),a("v-text-field",{attrs:{value:e.$store.state.gitlab.emailReportHours,label:"Report tasks to this email",hint:"If empty, do not report tasks details to an email. Use commas to separate emails.",required:""},on:{change:function(t){return e.$store.commit("gitlab/emailReportHours",t)}}})],1)]),a("v-text-field",{attrs:{value:e.$store.state.sessions.emailSessionTime,label:"Report session hours to this email",hint:"If empty, do not report session time. Use commas to separate emails.",required:""},on:{change:function(t){return e.$store.commit("sessions/emailSessionTime",t)}}})],1)],1)},Ge=[],Fe={computed:{tokenURL:function(){return"".concat(this.$store.state.gitlab.gitlab,"/profile/personal_access_tokens")},gitlabConfiguredProperly:function(){return this.$store.state.gitlab.gitlab&&this.$store.state.gitlab.privateToken},reportHours:{get:function(){return this.$store.state.gitlab.reportHours},set:function(e){this.$store.commit("gitlab/reportHours",e)}},showMilestones:{get:function(){return this.$store.state.gitlab.showMilestones},set:function(e){this.$store.commit("gitlab/showMilestones",e)}}}},Je=Fe,qe=a("0789"),ze=a("b73d"),Ke=Object(f["a"])(Je,Be,Ge,!1,null,null,null),We=Ke.exports;h()(Ke,{VCard:w["a"],VCardText:k["b"],VExpandTransition:qe["a"],VSwitch:ze["a"],VTextField:y["a"]});var Qe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-snackbar",{attrs:{color:e.type,timeout:e.timeout,top:""},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[e._v(" "+e._s(e.message)+" "),a("v-btn",{attrs:{dark:"",flat:""},on:{click:function(t){e.visible=!1}}},[e._v(" Close ")])],1)},Xe=[],Ze={data:function(){return{visible:!1,message:"",type:"error",timeout:6e3}},mounted:function(){var e=this;this.$store.subscribe((function(t){if("messages/message"===t.type){e.visible=!0;for(var a=["info","warning","error"],s=0;s<a.length;s++){var n=e.$store.getters["messages/lastMessage"](a[s]);n&&(e.type=a[s],e.message=n)}e.$store.commit("messages/clean")}}))}},et=Ze,tt=a("2db4"),at=Object(f["a"])(et,Qe,Xe,!1,null,null,null),st=at.exports;h()(at,{VBtn:_["a"],VSnackbar:tt["a"]});var nt=a("83b0");a("8bb7"),a("41e6");var rt={name:"app",components:{IssuesTable:ie,ReportBar:fe,CalendarView:nt["CalendarView"],CalendarViewHeader:nt["CalendarViewHeader"],SearchProject:je,ProjectGantt:Ue,SessionControl:Ne,MessageBar:st,ConfigTab:We},data:function(){return{activeTab:null,calendarDate:new Date,currentDate:new Date,selectedUser:"",selectedProjectId:void 0}},computed:Object(c["a"])({app_version:function(){return"2.2.2"},gitlabConfigured:function(){return this.gitlab&&this.privateToken},maxTasks:function(){return _e.PROJECTS_PER_PAGE}},Object(Z["c"])("gitlab",["loggedUser","currentUser","issues","calendarEvents","reportHours","emailReportHours","gitlab","users","privateToken","gitlabURL"]),{},Object(Z["c"])("sessions",["emailSessionTime"]),{},Object(Z["b"])("gitlab",["gitlabURL"])),mounted:function(){this.$store.dispatch("gitlab/login"),this.$store.dispatch("gitlab/getUsers"),this.privateToken&&this.gitlab?this.activeTab="tab-reporter":this.activeTab="tab-config"},methods:{setCalendarDate:function(e){this.calendarDate=e},changeUser:function(e){var t=this.users.filter((function(t){return t.id==e}));if(0!==t.length){var a=t[0];this.$store.commit("gitlab/currentUser",a),this.$store.dispatch("gitlab/getUserTasks")}},changeSelectedProject:function(e){this.selectedProjectId=e,this.$store.dispatch("gitlab/getProjectTasks",{projectId:this.selectedProjectId})},tabChanged:function(e){"tab-reporter"===e?this.$store.dispatch("gitlab/getUserTasks"):"tab-project"===e&&this.$store.dispatch("gitlab/getProjectTasks")}}},ot=rt,it=(a("034f"),a("0798")),ct=a("7496"),lt=a("40dc"),ut=a("a75b"),dt=a("553a"),pt=a("b974"),mt=a("71a3"),gt=a("c671"),vt=a("fe57"),ft=a("aac8"),bt=a("2a7f"),ht=Object(f["a"])(ot,o,i,!1,null,null,null),_t=ht.exports;h()(ht,{VAlert:it["a"],VApp:ct["a"],VAppBar:lt["a"],VCard:w["a"],VCardText:k["b"],VCol:pe["a"],VContainer:Ae["a"],VContent:ut["a"],VFooter:dt["a"],VIcon:se["a"],VRow:ne["a"],VSelect:pt["a"],VSpacer:T["a"],VTab:mt["a"],VTabItem:gt["a"],VTabs:vt["a"],VTabsItems:ft["a"],VToolbarTitle:bt["a"],VTooltip:re["a"]});a("ac1f"),a("1276");var wt=a("bc3a"),kt=a.n(wt),xt=(a("7ee5"),new window.Basil({namespace:"gitlab-reporter"})),Tt={loading:!1,emailReportHours:"",todos:[],users:[],issues:[],calendarEvents:[],loggedUser:{name:"UNAUTHENTICATED"},currentUser:{name:"UNAUTHENTICATED"},privateToken:null,gitlab:null,milestones:[],reportHours:!0,showMilestones:!0},yt={gitlabURL:function(e){return"".concat(e.gitlab,"/api/v4")}},jt={loggedUser:function(e,t){e.loggedUser=t,e.currentUser=t},currentUser:function(e,t){e.currentUser=t},privateToken:function(e,t){e.privateToken=t,xt.set("privateToken",t)},gitlab:function(e,t){e.gitlab=t,xt.set("gitlab",t)},users:function(e,t){e.users=t},emailReportHours:function(e,t){e.emailReportHours=t,xt.set("email-report-hours",t)},issues:function(e,t){e.issues=t},editIssue:function(e,t){var a=t.issueIndex,s=t.newMetadata;e.issues.splice(a,1,Object.assign({},e.issues[a],s))},calendarEvents:function(e,t){var a=t.calendarEvents,s=t.milestones;e.calendarEvents=a,e.milestones=s},loading:function(e,t){e.loading=t},showMilestones:function(e,t){var a="true"===t||!0===t;e.showMilestones=a,xt.set("show-milestones",a)},reportHours:function(e,t){var a="true"===t||!0===t;e.reportHours=a,xt.set("report-hours",a)}};function St(e){return Ot.apply(this,arguments)}function Ot(){return Ot=Object(d["a"])(regeneratorRuntime.mark((function e(t){var a,s,n,r,o,i,c,l,u,d;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=t.gitlab,s=t.privateToken,n=t.params,r=t.url,o=t.commit,a&&s){e.next=3;break}return e.abrupt("return",[]);case 3:return void 0===r&&(r="".concat(Tt.gitlab,"/api/v4/todos")),i=[],c=[],e.prev=6,e.next=9,kt.a.get(r,{params:n,headers:{"Private-Token":s}});case 9:i=e.sent,e.next=16;break;case 12:return e.prev=12,e.t0=e["catch"](6),o("messages/message",{type:"error",message:e.t0},{root:!0}),e.abrupt("return",[]);case 16:if(i)for(l=0;l<i.data.length;l++)u="target"in i.data[l]?i.data[l].target:i.data[l],u.assignee_names=u.assignees.map((function(e){return e.name})).join(),d=u.web_url.split("/"),u.project_name=d[d.length-3],u.project_namespace="".concat(d[d.length-4],"/").concat(u.project_name),u.project_url="".concat(a,"/").concat(u.project_namespace),u.report_hours=0,c.push(u);return e.abrupt("return",c);case 18:case"end":return e.stop()}}),e,null,[[6,12]])}))),Ot.apply(this,arguments)}function Rt(e){for(var t=[],a=[],s=0;s<e.length;s++){var n=e[s];if(n.due_date){var r={startDate:n.due_date,title:n.project_name+": "+n.title+" ("+n.time_stats.human_time_estimate+")",classes:"calendar-task"};t.push(r)}if(Tt.showMilestones&&n.milestone){var o=n.milestone.start_date?n.milestone.start_date:n.milestone.created_at,i=n.milestone.due_date;i&&-1==a.indexOf(n.milestone.iid)&&(t.push({startDate:o,endDate:i,title:n.milestone.title,classes:"calendar-milestone"}),a.push(n.milestone.iid))}}return{calendarEvents:t,milestones:a}}function Ct(e,t){if(t)for(var a=!1,s=0;s<t.length;s++){a=!0;for(var n=0;n<e.length;n++)if(e[n].id===t[s].id){a=!1;break}a&&e.push(t[s])}}var Et={login:function(e){return Object(d["a"])(regeneratorRuntime.mark((function t(){var a,s,n,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.commit,s=e.state,n=e.getters,s.gitlab){t.next=3;break}return t.abrupt("return");case 3:if(s.privateToken){t.next=6;break}return a("messages/message",{type:"error",message:"No token provided"},{root:!0}),t.abrupt("return");case 6:return r="".concat(n.gitlabURL,"/user"),t.prev=7,t.next=10,kt.a.get(r,{headers:{"Private-Token":s.privateToken}});case 10:o=t.sent,a("loggedUser",o.data),t.next=17;break;case 14:t.prev=14,t.t0=t["catch"](7),a("messages/message",{type:"error",message:t.t0},{root:!0});case 17:case"end":return t.stop()}}),t,null,[[7,14]])})))()},getUsers:function(e){return Object(d["a"])(regeneratorRuntime.mark((function t(){var a,s,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.commit,s=e.state,n=e.getters,s.gitlab){t.next=3;break}return t.abrupt("return");case 3:if(s.privateToken&&s.loggedUser){t.next=6;break}return a("messages/message",{type:"error",message:"No token provided"},{root:!0}),t.abrupt("return");case 6:return t.prev=6,t.next=9,kt.a.get("".concat(n.gitlabURL,"/users"),{params:{active:"true"},headers:{"Private-Token":s.privateToken}});case 9:r=t.sent,a("users",r.data),t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](6),a("messages/message",{type:"error",message:t.t0},{root:!0});case 16:case"end":return t.stop()}}),t,null,[[6,13]])})))()},getUserTasks:function(e){return Object(d["a"])(regeneratorRuntime.mark((function t(){var a,s,n,r,o,i,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.commit,s=e.state,n=e.getters,s.gitlab){t.next=3;break}return t.abrupt("return");case 3:if(s.privateToken&&s.loggedUser){t.next=6;break}return a("messages/message",{type:"error",message:"No token provided"},{root:!0}),t.abrupt("return");case 6:if(r=[],o={},a("loading",!0),a("issues",r),!s.loggedUser.is_admin){t.next=22;break}return t.next=13,St({gitlab:s.gitlab,privateToken:s.privateToken,params:{state:"pending",type:"Issue",sudo:s.currentUser.id,per_page:_e.PROJECTS_PER_PAGE}});case 13:return i=t.sent,Ct(r,i),t.next=17,St({gitlab:s.gitlab,privateToken:s.privateToken,params:{scope:_e.ASSIGNED_TO_ME,state:"opened",sudo:s.currentUser.id,per_page:_e.PROJECTS_PER_PAGE},url:"".concat(n.gitlabURL,"/issues"),commit:a});case 17:i=t.sent,Ct(r,i),o=Rt(r),t.next=31;break;case 22:return t.next=24,St({gitlab:s.gitlab,privateToken:s.privateToken,params:{state:"pending",type:"Issue",per_page:_e.PROJECTS_PER_PAGE},commit:a});case 24:return c=t.sent,Ct(r,c),t.next=28,St({gitlab:s.gitlab,privateToken:s.privateToken,params:{scope:_e.ASSIGNED_TO_ME,state:"opened",per_page:_e.PROJECTS_PER_PAGE},url:"".concat(n.gitlabURL,"/issues"),commit:a});case 28:c=t.sent,Ct(r,c),o=Rt(r);case 31:a("issues",r),a("calendarEvents",o),a("loading",!1);case 34:case"end":return t.stop()}}),t)})))()},getProjectTasks:function(e,t){return Object(d["a"])(regeneratorRuntime.mark((function a(){var s,n,r,o,i,c;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(s=e.commit,n=e.state,r=e.getters,n.gitlab){a.next=3;break}return a.abrupt("return");case 3:if(n.privateToken&&n.loggedUser){a.next=6;break}return s("messages/message",{type:"error",message:"No token provided"},{root:!0}),a.abrupt("return");case 6:if(o=[],i={},void 0!==t&&void 0!==t.projectId){a.next=12;break}return s("issues",[]),s("calendarEvents",[]),a.abrupt("return");case 12:return s("loading",!0),s("issues",o),a.next=16,St({gitlab:n.gitlab,privateToken:n.privateToken,params:{per_page:_e.PROJECTS_PER_PAGE},url:"".concat(r.gitlabURL,"/projects/").concat(t.projectId,"/issues"),commit:s});case 16:c=a.sent,Ct(o,c),i=Rt(o),s("issues",o),s("calendarEvents",i),s("loading",!1);case 22:case"end":return a.stop()}}),a)})))()},reportHours:function(e,t){return Object(d["a"])(regeneratorRuntime.mark((function a(){var s,n,r,o,i,c,l,u,d,p,m,g,v,f;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:s=e.commit,n=e.state,r=e.getters,o=t.date,i=[],c=0;case 4:if(!(c<n.issues.length)){a.next=34;break}if(l=n.issues[c],u=parseFloat(l.report_hours),d=l.report_comment,isNaN(u)||!(u>0)){a.next=30;break}if(p="/spend "+u+"h "+o,i.push({project_id:l.project_id,project_name:l.project_name,iid:l.iid,title:l.title,spendTxt:p,hours:u,comment:d}),m=!1,d&&(p=p+"\n"+d,m=d.indexOf("/done")+d.indexOf("/close")!==-2),!n.reportHours){a.next=30;break}return g="".concat(r.gitlabURL,"/projects/").concat(l.project_id,"/issues/").concat(l.iid,"/notes"),a.prev=15,a.next=18,kt.a.post(g,{body:p},{headers:{"Private-Token":n.privateToken}});case 18:a.next=22;break;case 20:a.prev=20,a.t0=a["catch"](15);case 22:if(m){a.next=30;break}return a.prev=23,a.next=26,kt.a.post(g,{body:"/todo"},{headers:{"Private-Token":n.privateToken}});case 26:a.next=30;break;case 28:a.prev=28,a.t1=a["catch"](23);case 30:s("editIssue",{issueIndex:c,newMetadata:{report_hours:0,report_comment:""}});case 31:c++,a.next=4;break;case 34:n.reportHours||s("messages/message",{type:"warning",message:"Not reporting hours to gitlab"},{root:!0}),n.emailReportHours&&(v=encodeURIComponent("".concat(o," hours to report")),f=encodeURIComponent(JSON.stringify(i,null,4)),f?window.open("mailto:".concat(n.emailReportHours,"?subject=").concat(v,"&body=").concat(f)):window.open("mailto:".concat(n.emailReportHours,"?subject=").concat(v)));case 36:case"end":return a.stop()}}),a,null,[[15,20],[23,28]])})))()},changeLabels:function(e,t){return Object(d["a"])(regeneratorRuntime.mark((function a(){var s,n,r,o,i,c;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return s=e.state,n=e.getters,r=t.issueIndex,o=s.issues[r],i=o.tags.join(","),c="".concat(n.gitlabURL,"/projects/").concat(o.project_id,"/issues/").concat(o.iid),a.prev=5,a.next=8,kt.a.put(c,{labels:i},{headers:{"Private-Token":s.privateToken}});case 8:a.next=12;break;case 10:a.prev=10,a.t0=a["catch"](5);case 12:case"end":return a.stop()}}),a,null,[[5,10]])})))()},loadState:{root:!0,handler:function(e){var t=e.commit;t("gitlab",xt.get("gitlab")),t("privateToken",xt.get("privateToken")),t("emailReportHours",xt.get("email-report-hours")),t("reportHours",xt.get("report-hours")),t("showMilestones",xt.get("show-milestones"))}}},Dt={namespaced:!0,state:Tt,mutations:jt,actions:Et,getters:yt},Pt=new window.Basil({namespace:"gitlab-reporter"}),It={emailSessionTime:"",activeSessions:[]},Ut={emailSessionTime:function(e,t){e.emailSessionTime=t,Pt.set("email-session-time",t)},activeSessions:function(e,t){e.activeSessions=t,Pt.set("active-sessions",t)},startSession:function(e){var t=Object(I["a"])();e.activeSessions.push({date:t.format("YYYY-MM-DD"),time:t.format("HH:mm"),action:"start"}),Pt.set("active-sessions",e.activeSessions)},stopSession:function(e){var t=Object(I["a"])();e.activeSessions.push({date:t.format("YYYY-MM-DD"),time:t.format("HH:mm"),action:"stop"}),Pt.set("active-sessions",e.activeSessions)}},Vt={startSession:function(e){return Object(d["a"])(regeneratorRuntime.mark((function t(){var a,s,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.commit,s=e.state,n=s.activeSessions[s.activeSessions.length-1],void 0===n||"start"!==n.action){t.next=5;break}return a("messages/message",{type:"error",message:"Starting an already started session"},{root:!0}),t.abrupt("return");case 5:r=encodeURIComponent(Object(I["a"])().format("YYYY-MM-DD HH:mm-?")),s.emailSessionTime?window.open("mailto:".concat(s.emailSessionTime,"?subject=").concat(r)):a("messages/message",{type:"warning",message:"Session emails is not set"},{root:!0}),a("startSession");case 8:case"end":return t.stop()}}),t)})))()},stopSession:function(e){return Object(d["a"])(regeneratorRuntime.mark((function t(){var a,s,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.commit,s=e.state,n=s.activeSessions[s.activeSessions.length-1],void 0===n||"stop"!==n.action){t.next=5;break}return a("messages/message",{type:"error",message:"Closing an already closed session"},{root:!0}),t.abrupt("return");case 5:r=encodeURIComponent(Object(I["a"])().format("YYYY-MM-DD ?-HH:mm")),s.emailSessionTime?window.open("mailto:".concat(s.emailSessionTime,"?subject=").concat(r)):a("messages/message",{type:"warning",message:"Session emails is not set"},{root:!0}),a("stopSession");case 8:case"end":return t.stop()}}),t)})))()},customSessions:function(e,t){return Object(d["a"])(regeneratorRuntime.mark((function a(){var s,n,r,o,i,c,l,u,d,p;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(s=e.commit,n=e.state,r=t.date,o=t.sessions,""!==o){for(i=r?Object(I["a"])(r).format("YYYY-MM-DD"):Object(I["a"])().format("YYYY-MM-DD"),c=encodeURIComponent("".concat(i," ").concat(o,"*")),n.emailSessionTime?window.open("mailto:".concat(n.emailSessionTime,"?subject=").concat(c)):s("messages/message",{type:"warning",message:"Session emails is not set"},{root:!0}),l=o.split(","),u=[],d=0;d<l.length;d++)p=l[d].split("-"),u.push({date:i,time:p[0],action:"start"}),void 0!==p[1]&&"?"!==p[1]&&u.push({date:i,time:p[1],action:"stop"});s("activeSessions",u)}else s("activeSessions",[]);case 3:case"end":return a.stop()}}),a)})))()},loadState:{root:!0,handler:function(e){var t=e.commit;t("emailSessionTime",Pt.get("email-session-time"));var a=Pt.get("active-sessions");if(a&&0!==a.length){var s=a[0];Object(I["a"])().isSame(s.date,"day")||(a=[],t("messages/message",{type:"info",message:"Old sessions cleaned out"},{root:!0}))}else a=[];t("activeSessions",a)}}},$t={namespaced:!0,state:It,mutations:Ut,actions:Vt},Mt={messages:{error:[],info:[],debug:[],warning:[]}},Lt={clean:function(e){e.messages={error:[],info:[],debug:[],warning:[]}},message:function(e,t){var a=t.type,s=t.message;a||(a="error"),e.messages[a].push(s),"info"===a||"debug"===a?P.log('INFO: type="'.concat(a,'" message="').concat(s,'"')):"warning"===a?P.warning('WARNING: message="'.concat(s,'"')):P.warning('ERROR: message="'.concat(s,'"'))},popMessage:function(e,t){var a=t.type;a||(a="error"),e.messages[a].pop()}},Ht={hasMessages:function(e){return e.messages.error.length+e.messages.warning.length+e.messages.info.length+e.messages.debug.length},lastMessage:function(e){return function(t){return t||(t="error"),0===e.messages[t].length?null:e.messages[t][e.messages[t].length-1]}}},At={namespaced:!0,state:Mt,mutations:Lt,getters:Ht};s["a"].use(Z["a"]);var Yt=new Z["a"].Store({modules:{gitlab:Dt,sessions:$t,messages:At},state:{config:_e}});s["a"].config.productionTip=!1,Yt.dispatch("loadState"),new s["a"]({store:Yt,render:function(e){return e(_t)},vuetify:r}).$mount("#app")},"8a23":function(e,t,a){},"9bca":function(e,t,a){"use strict";var s=a("3dc8"),n=a.n(s);n.a},a611:function(e,t,a){"use strict";var s=a("b747"),n=a.n(s);n.a},b747:function(e,t,a){},d647:function(e,t,a){"use strict";var s=a("f356"),n=a.n(s);n.a},f356:function(e,t,a){}});
//# sourceMappingURL=app.bfb0850c.js.map